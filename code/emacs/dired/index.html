<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,minimum-scale=1.0,user-scalable=0">
    <title>
      微醉 - Emacs Dired
    </title>
    <link rel="shortcut icon " type="images/x-icon" href="http://weizui.org/favicon.png">
    <link href="http://weizui.org/css/style.css" rel="stylesheet" >
    <link href="http://weizui.org/css/syntax.css" rel="stylesheet" >
  </head>
  <body>
    <header class="header">
  
  <h1 class="header--logobox">
    <a class="header--logo" href="http://weizui.org/">微醉</a>
  </h1>
  
  <nav id="nav" class="header--nav">
    <ul class="nav--menu list-unstyled">
      
      
        
        <li class="nav--item list-unstyled ">
          <a href="/code/">码记</a>
        
      
        
        <li class="nav--item list-unstyled ">
          <a href="/read/">札记</a>
        
      
        
        <li class="nav--item list-unstyled ">
          <a href="/note/">杂记</a>
        
      
        
        <li class="nav--item list-unstyled ">
          <a href="/alltaxonomies/">全部</a>
        
      
    </ul>
  </nav>
  
  <div id="mobilenavBtn" class="header--mobilenav">
    
    <div class="header--mobilenav-menu">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z" class="icon-menu"/></svg>
    </div>
  </div>
</header>

    <div class="container">
      
<div class="sidebar">
  
<div class="tags--box">
  <h2 class="tags--title">标签</h2>
  <ul class="tags--list list-unstyled">
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/angularjs">angularjs</a>
      <span class="tags--number"> (1)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/code">code</a>
      <span class="tags--number"> (5)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/command">command</a>
      <span class="tags--number"> (5)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/docker">docker</a>
      <span class="tags--number"> (2)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/editor">editor</a>
      <span class="tags--number"> (5)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/emacs">emacs</a>
      <span class="tags--number"> (4)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/git">git</a>
      <span class="tags--number"> (1)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/java">java</a>
      <span class="tags--number"> (1)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/latex">latex</a>
      <span class="tags--number"> (1)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/markdown">markdown</a>
      <span class="tags--number"> (1)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/operation">operation</a>
      <span class="tags--number"> (2)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/postgresql">postgresql</a>
      <span class="tags--number"> (1)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/vim">vim</a>
      <span class="tags--number"> (1)</span>
    </li>
    
    <li class="tags--item list-unstyled">
     <a class="tags--name" href="/tags/website">website</a>
      <span class="tags--number"> (1)</span>
    </li>
    
  </ul>
</div>
  
<div class="categories--box">
  <h2 class="categories--title">分类</h2>
  <ul class="categories--list list-unstyled">
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/android">android</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/angularjs">angularjs</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/docker">docker</a>
      <span class="categories--number"> (2)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/editor">editor</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/emacs">emacs</a>
      <span class="categories--number"> (5)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/git">git</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/java">java</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/latex">latex</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/markdown">markdown</a>
      <span class="categories--number"> (2)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/network">network</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/nodejs">nodejs</a>
      <span class="categories--number"> (2)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/orgmode">orgmode</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/other">other</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/php">php</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/postgresql">postgresql</a>
      <span class="categories--number"> (1)</span>
    </li>
    
    <li class="categories--item list-unstyled">
      <a class="categories--name" href="/categories/vim">vim</a>
      <span class="categories--number"> (1)</span>
    </li>
    
  </ul>   
</div>
</div>

<div class="single main main-offset">
  <div class="single--box">
    <div class="single--head">
      <h1 class="single--title">Emacs Dired</h1>
      <aside class="single--meta">
        <section>
          <span class="meta--date"> 2019-06-25 14:12 Tuesday </span>
          <span class="meta--wordcount">字数: 2704</span>
        </section>
        <div class="single--tags">
          
        </div>
      </aside>
    </div>
    <div>
      <article class="single--content">
        

<p>文件操作
常用操作
shell 命令
强大的重命名功能
排序和过滤
子目录操作
其他功能
nc.el</p>

<p>dired
dired 是 Emacs 自带的文件管理器，操作非常方便，再加上一些扩展之后无疑是 一个理想的文件管理器。。</p>

<p>Mark &amp; Flag
dired 最方便的一点就是可以对许多文件进行标记，并进行批量操作。
标记的方法有很多，最普通的标记就是 d 为当前文件贴上删除标签，之后可以使用 x 来 真正删除所有贴上删除标签的文件。</p>

<p>dired 还提供了许多预定义的方便的标记操作(当使用 C-u 传递一个前缀参数 时，他们执行相反操作，即去掉标记)，例如：</p>

<h1 id="为所有自动保存的文件-通常是文件名开始和结尾都是-的文件-贴上删除-标签">为所有自动保存的文件(通常是文件名开始和结尾都是 # 的文件)贴上删除 标签。</h1>

<p>~ 为所有备份文件(即文件名以 ~ 结尾的文件，Emacs 和 vi 等编辑器默认 情况下都会产生这样的文件)贴上删除标签。
&amp; 为“垃圾文件”(看 dired-garbage-files-regexp 的值可以知道 dired 把 哪些文件当作了垃圾文件)贴上删除标签。
通常这些命令可以方便地帮你清理垃圾，如果还不满意，可以使用 % d REGEXP <RET> 来输入自己的正则表达式，匹配到的文件会被贴上删除标签。</p>

<p>当然，能用的标签并不止是 D (即删除标签)，几乎任何一个字符都可以使用，不 过最常用的还是 * ， m 命令即是以 * 标记当前文件。
同样，dired 提供了很多 方便的标记操作(这些命令在传递一个前缀参数的时候都会执行相反的操作，例如 C-u * * 会去掉所有可执行文件的标记)：</p>

<ul>
<li>*   标记所有可执行文件。</li>
<li>@   标记所有符号链接。</li>
<li>/   标记所有目录(不包括 . 和 .. )。</li>
<li>s   标记所有文件(不高考 . 和 .. )。</li>
<li>.   标记具有给定扩展名的文件。
% m REGEXP <RET> 或 * % REGEXP <RET> 标记所有匹配到给定的正则表达式 的文件。
% g REGEXP <RET> 标记所有文件 内容 匹配到给定的正则表达式的文件。</li>
</ul>

<p>u 去除当前行的标记。
<DEL> 上移一行并去除该行的标记。
U 去除所有标记。
* ? MARKCHAR 或 M-<DEL> 去除所有以 MARKCHAR 标记的文件的标记，如果 传递一个前缀参数，则会对每一个文件要求你确认是否去除标记。
t 交换标记，即所有原来标记为 * 的文件被置于未标记状态，原来未标记的 文件被标记为 * ，原来有其他标记的文件不受影响。
上面的操作都是使用 * 进行标记，但是 dired 可以使用更多的字符进行标记， 只是没有提供相应的快捷键操作而已，你可以先以 * 标记，然后使用 * c OLD-MARKCHAR NEW-MARKCHAR 来把 * 标记变换成其他标记，几乎任何字符(当然 不包括中文这种多字节的字符)都可以作为标记，不过空格被特殊对待，用于表示 所有未标记的文件。</p>

<p>列举了这么多命令，多少有些枯燥，作为一个例子，我们来把当前目录下的所有 备份文件移动到 ~/backup 目录下。
假设当前目录已经有一些文件被你以 D 标 记，但是暂时还不想删除：</p>

<p>选择个临时标记，比如 t ，只要保证当前 buffer 里面没有已经存在的 这种标记就行了。
* c D t 把当前所有 D 标签换为 t 标签。
~ 以 D 标记所有备份文件。
* c D * 把 D 标签换为 * 标签。
R ~/backup <RET> 来把所有标记为 * 的文件移动到 ~/backup 目录里面。
* c t D 恢复原来的 D 标记。
当然这要假设你原来没有设定其他的 * 标记，要不然你也可以再添加一个临时 标记。总之操作和清晰也很方便，感觉像在汇编语言里面使用寄存器一样，大多 数批量操作都是针对 * 标记的，所以对某个标记操作之前需要把他先转换为 * 标记。</p>

<p>另外，还有一个非常强大的标记的方法，绑定到 M-( 或 * ( 上。它可以让你使 用断言来决定标记哪些文件。 C-h f dired-mark-sexp RET 可以得到详细的文档。 这个功能非常强大，有点类似于 find 程序，例如，标记所有没有编译的Elisp 文件(如果编译了，那么会有一个同名，但是扩展名为 .elc 的文件存在) 的方法 是输入这个断言： (and (string-match &ldquo;\.el$&rdquo; name) (not (file-exists-p (concat name &ldquo;c&rdquo;)))) 。</p>

<p>文件操作
dired 内建了很多文件操作，对于操作的文件有一个统一的约定，按照顺序是：</p>

<p>如果你通过 C-u 传递一个前缀参数 N ，那么它对从当前行开始的 N 行执 行操作( N 也可以是负数)。
如果有被标记为 * 的文件，则以这些文件为操作对象。
只对当前光标所在的文件进行操作。
常用操作
这些命令全部绑定到大写字母上，记忆也非常方便：</p>

<p>C 拷贝文件。把 dired-recursive-copies 设为非 nil 的值可以递归拷贝目 录，通常我们设定为 top ，这表示对于顶层目录 dired 会先进行询问是否 要递归拷贝，而其中的子目录则不再询问。如果嫌询问太麻烦，可以直接设 置为 always 。
D 删除文件。类似的有一个 dired-recursive-deletes 变量可以控制递归删 除。
R 重命名文件，也就是移动文件。
H 创建硬链接。
S 创建软链接。
M 修改权限位，即 shell 里面的 chmod 命令。
G 修改文件所属的组。
O 修改文件的所有者。
T 修改文件的修改时间，类似于 shell 命令 touch 。
P 打印文件。
Z 压缩或解压文件。
L 把 Elisp 文件加载进 Emacs 。
B 对 Elisp 文件进行 Byte compile 。
A 对文件内容进行正则表达式搜索，搜索会在第一个匹配的地方停下，然后 可以使用 M-, 搜索下一个匹配。
Q 对文件内容进行交互式的正则表达式替换。
shell 命令
除了这些操作，还可以使用 ! 来执行 shell 命令。这里介绍了自动猜测 shell 命令的办法，就类似于通常的文件管理器里面以关联的程序打开了。</p>

<p>强大的重命名功能
dired 有一个文件名转换的理念，所以转换，并不一定是重命名，还可以是复制 和创建链接。所以，除了 % u 和 % l 重命名原文件为大写、小写外，一个使用 正则表达式进行转换的命令提供了四个选项： % X 其中 X 可以是 R , C , H 和 S ，分别代表重命名、复制、创建硬链接和创建软链接，他们使用匹配和替换的 机制，这有点像 rename 这个程序，例如： % R .[^.]*$ <RET> .1&amp; <RET> 给原来的文件名加个标号 1 ，把 foo.txt 变成 foo.1.txt 。</p>

<p>另外，dired 还有一个叫做 Wdired 的扩展可以直接在 dired 的 buffer 里面编 辑文件名来达到重命名的效果。使用 M-x wdired-change-to-wdired-mode 进入 编辑模式，这个时候可以直接像编辑普通文本一样编辑文件名，还可以添加路径 来实现把文件移动到其他目录。除了文件名可以编辑以外，其他部分被标记为只 读，但是如果把 wdired-allow-to-change-permissions 设为 t 的话，还可以 编辑文件的权限位。编辑完成之后使用 C-c C-c 来应用所做的编辑。非常方便。</p>

<p>排序和过滤
dired 有方便的排序功能，这里介绍了如何方便地使用排序功能。另外 dired 还有一个 k 用于去掉不想显示出来的文件，它并不删除磁盘上的文件，只是临 时从 dired 的 buffer 中去掉他们， g 刷新一下它们又会显示出来，这样，首 先用强大的标记功能进行标记，然后使用 k 去掉，就实现了过滤的功能。</p>

<p>子目录操作
dired 允许同时操作当前目录和子目录。在 dired-listing-switches 里面加入 R 选项就可以显示子目录，如果只是想临时显示某个子目录的内容，对该目录执 行 i 操作就会把该子目录的内容添加到 dired 当前 buffer 的末尾并把光标移 动到那里，dired 在移动之前会先设置一个 mark ，所以可以使用 C-u C-<SPC> (对于我来说，我把 set-mark-command 绑定到了 M-<SPC> 上，这里自然就是使 用 C-u M-<SPC> 了)回到原来的位置。</p>

<p>关于子目录的更多方便的操作可以参见 Emacs 的 info 文档。</p>

<p>其他功能
还有一些方便的功能，我把几个常用的命令列在这里：</p>

<ul>
<li>创建目录
w 复制文件名，如果通过 C-u 传递一个前缀参数 0 ，则复制决定路径名， 如果只是 C-u 则复制相对于 dired 当前目录的相对路径。
I 把当前文件以 info 文档的格式打开。
N 把当前文件以 man 格式打开(使用 WoMan)。
Y 为所有标记的文件创建一个到指定目录的相对符号连接(即使用相对路径进 行引用，而不是绝对路径)。</li>
</ul>

      </article>
    </div>
    <nav class="single--nav">
    <div>
      
      <span>上一篇:</span>
      <a href="http://weizui.org/code/network/http-header/"> Http Header Field</a>
      
    </div>
    <div>
      
      <span>下一篇:</span>
      <a href="http://weizui.org/code/emacs/markdown/"> Markdown</a>
      
    </div>
    </nav>
  </div>
  <div class="table-of-contents">
    <nav id="TableOfContents">
<ul>
<li><a href="#为所有自动保存的文件-通常是文件名开始和结尾都是-的文件-贴上删除-标签">为所有自动保存的文件(通常是文件名开始和结尾都是 # 的文件)贴上删除 标签。</a></li>
</ul>
</nav>
  </div>
  
</div>

    </div>
    <footer class="footer">
  <span>&copy;2018 </span>
  <span>Powered By </span>
  <a href="http://gohugo.io/" target="_blank">Hugo</a>
</footer>
    <script src="http://weizui.org/js/index.js"></script>
  </body>
</html>
